{"version":3,"sources":["node_modules/browser-pack/_prelude.js","public/js/sw/index.js","public/js/sw/preroll/index.js"],"names":[],"mappings":"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","file":"sw.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var staticCacheName = 'wittr-static-v8';\r\nvar contentImgsCache = 'wittr-content-imgs';\r\nvar allCaches = [\r\n  staticCacheName,\r\n  contentImgsCache\r\n];\r\n\r\nself.addEventListener('install', function(event) {\r\n  event.waitUntil(\r\n    caches.open(staticCacheName).then(function(cache) {\r\n      return cache.addAll([\r\n        '/skeleton',\r\n        'js/main.js',\r\n        'css/main.css',\r\n        'imgs/icon.png',\r\n        'https://fonts.gstatic.com/s/roboto/v15/2UX7WLTfW3W8TclTUvlFyQ.woff',\r\n        'https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOD8E0i7KZn-EPnyo3HZu7kw.woff'\r\n      ]);\r\n    })\r\n  );\r\n});\r\n\r\nself.addEventListener('activate', function(event) {\r\n  event.waitUntil(\r\n    caches.keys().then(function(cacheNames) {\r\n      return Promise.all(\r\n        cacheNames.filter(function(cacheName) {\r\n          return cacheName.startsWith('wittr-') &&\r\n                 !allCaches.includes(cacheName);\r\n        }).map(function(cacheName) {\r\n          return caches.delete(cacheName);\r\n        })\r\n      );\r\n    })\r\n  );\r\n});\r\n\r\nself.addEventListener('fetch', function(event) {\r\n  var requestUrl = new URL(event.request.url);\r\n\r\n  if (requestUrl.origin === location.origin) {\r\n    if (requestUrl.pathname === '/') {\r\n      event.respondWith(caches.match('/skeleton'));\r\n      return;\r\n    }\r\n    if (requestUrl.pathname.startsWith('/photos/')) {\r\n      event.respondWith(servePhoto(event.request));\r\n      return;\r\n    }\r\n    if (requestUrl.pathname.startsWith('/avatars/')) {\r\n      event.respondWith(serveAvatar(event.request));\r\n      return;\r\n    }\r\n    // TODO: respond to avatar urls by responding with\r\n    // the return value of serveAvatar(event.request)\r\n  }\r\n\r\n  event.respondWith(\r\n    caches.match(event.request).then(function(response) {\r\n      return response || fetch(event.request);\r\n    })\r\n  );\r\n});\r\n\r\nfunction serveAvatar(request) {\r\n  var storageUrl = request.url.replace(/-\\dx\\.jpg$/, '');\r\n\r\n    return caches.open(contentImgsCache).then(function(cache) {\r\n      return cache.match(storageUrl).then(function(response) {\r\n        if (response) return response;\r\n\r\n      return fetch(request).then(function(networkResponse) {\r\n        cache.put(storageUrl, networkResponse.clone());\r\n        return networkResponse;\r\n      });\r\n    });\r\n  });\r\n  // Avatar urls look like:\r\n  // avatars/sam-2x.jpg\r\n  // But storageUrl has the -2x.jpg bit missing.\r\n  // Use this url to store & match the image in the cache.\r\n  // This means you only store one copy of each avatar.\r\n  // var storageUrl = request.url.replace(/-\\dx\\.jpg$/, '');\r\n\r\n  // TODO: return images from the \"wittr-content-imgs\" cache\r\n  // if they're in there. But afterwards, go to the network\r\n  // to update the entry in the cache.\r\n  //\r\n  // Note that this is slightly different to servePhoto!\r\n}\r\n\r\nfunction servePhoto(request) {\r\n  var storageUrl = request.url.replace(/-\\d+px\\.jpg$/, '');\r\n\r\n  return caches.open(contentImgsCache).then(function(cache) {\r\n    return cache.match(storageUrl).then(function(response) {\r\n      if (response) return response;\r\n\r\n      return fetch(request).then(function(networkResponse) {\r\n        cache.put(storageUrl, networkResponse.clone());\r\n        return networkResponse;\r\n      });\r\n    });\r\n  });\r\n}\r\n\r\nself.addEventListener('message', function(event) {\r\n  if (event.data.action === 'skipWaiting') {\r\n    self.skipWaiting();\r\n  }\r\n});","var r=FetchEvent.prototype.respondWith\r\nFetchEvent.prototype.respondWith=function(){return new URL(this.request.url).search.endsWith(\"bypass-sw\")?void 0:r.apply(this,arguments)}"]}